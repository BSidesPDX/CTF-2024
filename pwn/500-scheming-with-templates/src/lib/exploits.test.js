const { compile, run, EvaluationContext } = require("./interpreter");
const constants = require("./constants");

const exploit1 = `
(define '__proto__' (lambda (list ) 1))
(define 'fn' (ref 'constructor'))
(define 'exploit' (fn '{console.log("vulnerable"); return 42}'))
(exploit)
`;

describe("exploits", () => {
  test("first attempt", () => {
    expect(run(exploit1, new EvaluationContext(constants))).toEqual({
      result: "42",
      stdout: "",
    });
  });
});
